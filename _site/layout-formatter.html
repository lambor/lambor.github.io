<html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1" /><title>当我们谈 XML 布局文件代码的优雅性</title><meta name="twitter:card" content="summary" /><meta name="twitter:site" content="@drak11t" /><meta name="twitter:title" content="当我们谈 XML 布局文件代码的优雅性" /><meta name="twitter:description" content="当我们谈代码的优雅性，是不可以忽略经常在打交道的 Android XML 布局文件的书写。有人会问，XML 文件内容有什么优雅不优雅的，不都是随便写吗？嗯，是有很多人，根本就没有意识到或者不关心布局文件内容应该怎么写更好看，更漂亮。我觉得，优雅的 Android XML 布局文件的内容，应该做到以下几点："><meta name="description" content="当我们谈代码的优雅性，是不可以忽略经常在打交道的 Android XML 布局文件的书写。有人会问，XML 文件内容有什么优雅不优雅的，不都是随便写吗？嗯，是有很多人，根本就没有意识到或者不关心布局文件内容应该怎么写更好看，更漂亮。我觉得，优雅的 Android XML 布局文件的内容，应该做到以下几点："><link rel="icon" href="/assets/favicon.png"><link rel="apple-touch-icon" href="/assets/gravatar.png"><link rel="stylesheet" href="//code.cdn.mozilla.net/fonts/fira.css"><link rel="stylesheet" href="/assets/core.css"><link rel="canonical" href="/layout-formatter"><link rel="alternate" type="application/atom+xml" title="Black history of Drakeet" href="/feed.xml" /></head><body><aside class="logo"> <a href="/"> <img class="gravatar" width="80px" height="80px" src="/assets/gravatar.png"> </a> <span class="logo-prompt">返回</span></aside><main> <noscript><style> article .footnotes { display: block; }</style></noscript><article><div class="center"><h1>当我们谈 XML 布局文件代码的优雅性</h1><time>4 24, 2016</time></div><div class="divider"></div><p>当我们谈代码的优雅性，是不可以忽略经常在打交道的 Android <code class="highlighter-rouge">XML</code> 布局文件的书写。有人会问，<code class="highlighter-rouge">XML</code> 文件内容有什么优雅不优雅的，不都是随便写吗？嗯，是有很多人，根本就没有意识到或者不关心布局文件内容应该怎么写更好看，更漂亮。我觉得，优雅的 Android <code class="highlighter-rouge">XML</code> 布局文件的内容，应该做到以下几点：</p><ul><li>不能有多余的空行；</li><li>不要保留你注释掉的代码（要回溯我们有 git）；</li><li>尽量避免 hard code（硬编码）；</li><li>能复用的资源尽量抽出到对应的 value 文件；</li><li>尽量消除警告、单词拼写错误；</li><li>不要使用废弃的关键词，如 <code class="highlighter-rouge">fill_parent</code>、<code class="highlighter-rouge">dip</code>；</li><li><strong>属性条目要有序；</strong></li></ul><p>其中，本文特别想讲的就是最后一条，“属性条目要有序”，属性条目指的是，比如一个 <code class="highlighter-rouge">ImageView</code> 节点下的 <code class="highlighter-rouge">android:id</code>, <code class="highlighter-rouge">android:layout_width</code>, <code class="highlighter-rouge">android:paddingLeft</code>, <code class="highlighter-rouge">android:src</code> … 等等这些。<strong>大部分人在书写 Android XML 布局文件的时候，都是想到一个要设置的属性，就随意在原有的属性们之下一行，再加上一行新属性</strong>，这样导致诸如 <code class="highlighter-rouge">android:id</code> 有时会在最后一行，有时在一堆属性中间，不仅不利于我们在需要 id 的时候，肉眼查找阅读，也会使得整个 <code class="highlighter-rouge">XML</code> 文件内容没有规则，很凌乱。</p><p>所以我大致是给自己定了一个规则，就是 <code class="highlighter-rouge">style</code> 必须排第一个，紧接着 <code class="highlighter-rouge">visibility</code>、<code class="highlighter-rouge">id</code>，然后是一堆 <code class="highlighter-rouge">layout</code> 属性，再然后是内边距 <code class="highlighter-rouge">padding</code> 属性，而一些值设定，比如 <code class="highlighter-rouge">color、text、background、src</code> … 我则规定它们必须处于最底下，这样在查看值的时候，只要着眼于最底下就可以找到目标属性和它的设定值了。</p><p>我们可以看一份随意书写的 <code class="highlighter-rouge">XML</code> 文件和按照一定顺序规则书写的 <code class="highlighter-rouge">XML</code> 文件内容对比：</p><h6><img class="aligncenter" src="http://ww1.sinaimg.cn/large/86e2ff85gw1f383wa95tej21ge0m5ai0.jpg" /></h6><p>上图中，左边是随意书写、乱序的，右图则是按照一定顺序规则有序的，相比之下，我想应该都会觉得右图看起来舒服许多，而且益处应该也是比较明显的。</p><p>为了优雅性，以前我都是手动进行排序，<code class="highlighter-rouge">id</code> 手动写前头，<code class="highlighter-rouge">text</code> 手动写在末尾，直到最近，因为与人协作，不得不面对大量遗留下来的左图式的 <code class="highlighter-rouge">XML</code> 文件，忽然想起可以写一个 Idea/AndroidStudio 插件来自动化格式化这些文件内容。于是下载了 Idea 社区版，查看了几下官方文档和一个小示例，就摸索着写起了，最终完成了本文想要推荐 <code class="highlighter-rouge">LayoutFormatter</code>.</p><p>这是我开发并且完全开源的一个 <code class="highlighter-rouge">Idea/AndroidStudio</code> 插件，通过 <code class="highlighter-rouge">右键 -&gt; Refactor -&gt; Reformat Layout XML</code>. 即可一键格式化你的 <code class="highlighter-rouge">XML</code> 文件，甚至可以一键格式化你整个项目或某个文件夹下的所有 <code class="highlighter-rouge">XML</code> 文件：</p><p><a href="https://github.com/drakeet/LayoutFormatter" target="_blank">https://github.com/drakeet/LayoutFormatter</a></p><p>最近它的更新：</p><ul><li>调整了格式化 Action 的位置到 <code class="highlighter-rouge">右键 -&gt; Refactor -&gt; Reformat Layout XML</code>.；</li><li>支持 撤销；</li><li>支持 对非 <code class="highlighter-rouge">XML</code> 文件进行过滤；</li><li>支持 默认快捷键；</li><li>支持 一键对整个项目或某个文件夹下的所有 <code class="highlighter-rouge">XML</code> 文件进行格式化；</li><li>支持 自动把 <code class="highlighter-rouge">fill_parent</code> 转为 <code class="highlighter-rouge">match_parent</code>，把 <code class="highlighter-rouge">dip</code> 转成 <code class="highlighter-rouge">dp</code>.</li></ul><p>希望你能喜欢并享受它 ^ ^</p></article></main></body></html>